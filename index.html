<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dictado a Texto</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap');

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            padding: 30px 40px;
            width: 90%;
            max-width: 600px;
            text-align: center;
        }

        h1 {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        p {
            font-weight: 300;
            color: #555;
            margin-bottom: 25px;
        }

        .botones {
            display: flex;
            gap: 15px; /* Espacio entre botones */
            justify-content: center;
            margin-bottom: 20px;
        }

        button {
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #boton-grabar {
            background-color: #2ecc71; /* Verde */
            color: white;
        }

        #boton-grabar:hover {
            background-color: #27ae60;
            box-shadow: 0 6px 15px rgba(46, 204, 113, 0.3);
        }

        #boton-parar {
            background-color: #e74c3c; /* Rojo */
            color: white;
        }

        #boton-parar:hover {
            background-color: #c0392b;
            box-shadow: 0 6px 15px rgba(231, 76, 60, 0.3);
        }

        #estado {
            font-weight: 500;
            color: #3498db; /* Azul */
            height: 20px; /* Altura fija para que no salte el dise√±o */
            margin-bottom: 15px;
            visibility: hidden; /* Oculto por defecto */
        }

        textarea {
            width: 100%;
            height: 200px;
            border-radius: 8px;
            border: 2px solid #dfe6e9;
            padding: 15px;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            box-sizing: border-box; /* Para que el padding no afecte el ancho */
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            border-color: #3498db;
            outline: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>üéôÔ∏è Dictado a Texto</h1>
        <p>Presiona "Grabar" y habla. Tu transcripci√≥n aparecer√° en el cuadro de texto.</p>

        <div class="botones">
            <button id="boton-grabar">‚ñ∂Ô∏è Grabar</button>
            <button id="boton-parar">‚èπÔ∏è Parar</button>
        </div>

        <div id="estado">Escuchando...</div>

        <textarea id="resultado" placeholder="Aqu√≠ aparecer√° tu transcripci√≥n..."></textarea>
    </div>

    <script>
        // 1. Verificar si el navegador soporta la API
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            alert("Tu navegador no soporta la Web Speech API. Intenta con Chrome o Edge.");
        }

        // 2. Crear una instancia y obtener elementos del DOM
        const recognition = new SpeechRecognition();
        const textareaResultado = document.getElementById('resultado');
        const estado = document.getElementById('estado');

        // 3. Configuraci√≥n
        recognition.lang = 'es-AR'; // Espa√±ol (Argentina)
        recognition.interimResults = false; 
        recognition.continuous = true; 

        // 4. Manejar el evento 'onresult'
        recognition.onresult = (event) => {
            let transcripcionCompleta = textareaResultado.value;
            for (let i = event.resultIndex; i < event.results.length; ++i) {
                if (event.results[i].isFinal) {
                    transcripcionCompleta += event.results[i][0].transcript + '. ';
                }
            }
            textareaResultado.value = transcripcionCompleta;
        };

        // 5. Manejar errores
        recognition.onerror = (event) => {
            console.error('Error en el reconocimiento de voz:', event.error);
        };

        // 6. Asignar funciones a los botones
        document.getElementById('boton-grabar').addEventListener('click', () => {
            recognition.start();
            estado.style.visibility = 'visible'; // Muestra "Escuchando..."
            console.log('Grabaci√≥n iniciada...');
        });

        document.getElementById('boton-parar').addEventListener('click', () => {
            recognition.stop();
            estado.style.visibility = 'hidden'; // Oculta "Escuchando..."
            console.log('Grabaci√≥n detenida.');
        });
        
        // 7. Limpiar el estado cuando el reconocimiento termina
        recognition.onend = () => {
            estado.style.visibility = 'hidden';
            console.log('El reconocimiento se detuvo.');
        };

    </script>

</body>
</html>
